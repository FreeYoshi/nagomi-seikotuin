# パスワードリセット機能追加

## 📧 **Supabase無料プランでのパスワードリセット機能**

Supabaseの無料プランでメール認証機能が利用可能です。パスワードリセット機能を実装しました。

## ✅ **追加機能**

### 1. **ログイン画面でのパスワード忘れ対応**
- 「パスワードを忘れた場合」リンク追加
- メールアドレス入力でリセットリンク送信
- Supabase Auth の `resetPasswordForEmail()` を使用

### 2. **パスワードリセット専用画面**
- メール認証後の新パスワード設定
- URLパラメータ（access_token, type=recovery）を自動検出
- バリデーション機能（6文字以上、確認入力）

### 3. **管理画面内でのパスワード変更**
- 従来の「現在のパスワード必要」方式を廃止
- メール認証による安全なパスワード変更
- セキュリティ強化による誤操作防止

## 🔧 **技術仕様**

### Supabase Auth設定
```javascript
// パスワードリセット送信
await supabase.auth.resetPasswordForEmail(email, {
    redirectTo: `${window.location.origin}/admin.html`
});

// パスワード更新（認証後）
await supabase.auth.updateUser({
    password: newPassword
});
```

### 画面遷移フロー
1. **ログイン画面** → 「パスワード忘れ」クリック
2. **リセット画面** → メール送信 → 成功メッセージ
3. **メール受信** → リンククリック
4. **パスワード更新画面** → 新パスワード設定
5. **ログイン画面** → 新パスワードでログイン

## ⚙️ **Supabase設定要件**

### メール設定（Supabase Dashboard）
```
Authentication → Settings → Email Templates
- Password Recovery Template を有効化
- Redirect URL に https://your-domain.com/admin.html を設定
```

### 無料プランでの制約
- **月1,000通まで** の認証メール送信可能
- カスタムSMTP設定は有料プラン（自動メールでも十分）

## 🎯 **使用方法**

### 管理者がパスワードを忘れた場合
1. ログイン画面で「パスワードを忘れた場合」をクリック
2. 登録済みメールアドレスを入力
3. 届いたメールのリンクをクリック
4. 新しいパスワードを設定

### 管理画面からのパスワード変更
1. 管理画面の「パスワード変更」セクション
2. メールアドレスを入力してリセットリンク送信
3. メールのリンクから新パスワード設定

これで無料プランでも安全なパスワード管理が可能になりました！